more function and nested lopps
